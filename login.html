<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Log in</title>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <!-- JQuery-->
    <script src="https://code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
    <!--custom css-->
    <link rel="stylesheet" type="text/css" href="css/JT.css">

    <!-- Vue.js -->
    <script src="https://unpkg.com/vue/dist/vue.js"></script>
</head>
<body>

<!--<script>-->
    <!--window.fbAsyncInit = function() {-->
        <!--FB.init({-->
            <!--appId      : '562233563985613',-->
            <!--xfbml      : true,-->
            <!--version    : 'v2.6'-->
        <!--});-->
    <!--};-->

    <!--(function(d, s, id){-->
        <!--var js, fjs = d.getElementsByTagName(s)[0];-->
        <!--if (d.getElementById(id)) {return;}-->
        <!--js = d.createElement(s); js.id = id;-->
        <!--js.src = "//connect.facebook.net/hr_HR/sdk.js";-->
        <!--fjs.parentNode.insertBefore(js, fjs);-->
    <!--}(document, 'script', 'facebook-jssdk'));-->
<!--</script>-->
<!--<div id="navigacija"></div>-->
<div class="container">


    <h2>Prijavi se</h2>
    <p> Nemaš račun? Registriraj se <a href="registracija.html">ovdje!</a></p>
    <div class="input-group input-group-lg">
        <span class="input-group-addon" id="sizing-addon1" style="width: 7ex">@</span>
        <input type="text" class="form-control" placeholder="Username" aria-describedby="sizing-addon1">
    </div>
    <p>

    </p>
    <div class="input-group input-group-lg">
        <span class="input-group-addon" id="sizing-addon2" style="width: 7ex">$</span>
        <input type="text" class="form-control" placeholder="Password" aria-describedby="sizing-addon1">
    </div>
    <div>
    <br>
        <button type="button" class="btn btn-primary btn-lg" onclick="window.location.href='postavke_korisnik.html'">Prijava</button>

        <br><br>

        <div class="fb-login-button" data-max-rows="1" data-size="xlarge" data-show-faces="false"
             data-auto-logout-link="true" data-scope="public_profile,email" data-onlogin="checkLoginState();"></div>
    </div>
</div>

<div id="footer"></div>

<script>
    $('#footer').load('Footer.html');
    $('#navigacija').load('navigacija.html');

    $.getScript('//connect.facebook.net/hr_HR/sdk.js', function(){
        FB.init({
            appId      : '562233563985613',
            xfbml      : true,
            version    : 'v2.6'
        });

        checkLoginState();
    });

    // facebook login
    function checkLoginState() {
        FB.getLoginStatus(function(response) {
            console.log(response);
            //provjeri i je li već ulogiran u aplikaciju
            if (response.status === 'connected' && !localStorage.getItem("id")) {
                //korisnik je ulogiran u aplikaciju i facebook
                FB.api('/me/?fields=first_name,last_name,email', function(odgovor) {
                    if (odgovor && !odgovor.error) {
                        console.log(JSON.stringify(odgovor));
                        localStorage.setItem("id", odgovor.id);
                        localStorage.setItem("firstName", odgovor.first_name);
                        localStorage.setItem("lastName", odgovor.last_name);
                        localStorage.setItem("mail", odgovor.email);

                        //preusmjeri korisnika na drugu stranicu nakon logina
                        window.location = "ustanova.html";
                    }
                });

            }
        });
    }



</script>
</body>
</html>